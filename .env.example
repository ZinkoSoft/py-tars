########################################
# Global / Broker
########################################
# Copy to .env and edit values
MQTT_USER=tars
MQTT_PASS=change_me
MQTT_HOST=127.0.0.1
MQTT_PORT=1883

# Logging level: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

########################################
# STT Worker (apps/stt-worker)
########################################
# Whisper model: tiny, base, small, medium (small is a good default)
WHISPER_MODEL=small
# Backend: whisper | ws
STT_BACKEND=whisper
# WS STT endpoint (used when STT_BACKEND=ws)
WS_URL=ws://127.0.0.1:9000/stt

# Audio & VAD
SAMPLE_RATE=16000
CHUNK_DURATION_MS=30
VAD_AGGRESSIVENESS=2
SILENCE_THRESHOLD_MS=1000

# Half-duplex / publish cadence
POST_PUBLISH_COOLDOWN_MS=400
UNMUTE_GUARD_MS=1000

# Echo suppression
ECHO_SUPPRESS_MATCH=1

# TTS mute window estimation (for avoiding self-echo)
TTS_BASE_MUTE_MS=1200
TTS_PER_CHAR_MS=45
TTS_MAX_MUTE_MS=12000

# Noise floor and quality gates
NOISE_MIN_DURATION_MS=400
NOISE_MIN_RMS=180
NOISE_FLOOR_INIT=180
NOISE_FLOOR_ALPHA=0.05
NOISE_GATE_OFFSET=1.5
NOISE_MIN_ALPHA_RATIO=0.55
NOISE_MIN_LENGTH=3
NOISE_MAX_PUNCT_RATIO=0.35

# Cough/polite-phrase guardrails
COUGH_ACTIVE_MIN_RATIO=0.25
COUGH_MIN_DURATION_MS=600
COUGH_SUSPICIOUS_PHRASES=thank you,hello,okay,hi
COUGH_MIN_SYLLABLES=2

# Whisper metrics gates
NO_SPEECH_MAX=0.60
AVG_LOGPROB_MIN=-1.20
DICT_MATCH_MIN_RATIO=0.40
REPEAT_COOLDOWN_SEC=8

# Streaming partials
STREAMING_PARTIALS=1
PARTIAL_INTERVAL_MS=600
PARTIAL_MIN_DURATION_MS=500
PARTIAL_MIN_CHARS=4
PARTIAL_MIN_NEW_CHARS=2
PARTIAL_ALPHA_RATIO_MIN=0.5

# Server-side tail window (also used in server/stt-ws)
TAIL_WINDOW_SEC=6.0

# FFT publishing for UI
FFT_PUBLISH=1
FFT_TOPIC=stt/audio_fft
FFT_RATE_HZ=12
FFT_BINS=64
FFT_LOG_SCALE=1

# Optional suppression quality upgrades (off by default)
SUPPRESS_USE_SYLLAPY=0
SUPPRESS_USE_RAPIDFUZZ=0
ECHO_FUZZ_MIN_RATIO=0.85

########################################
# Router (apps/router)
########################################
# Optional profile tag (not used in code; for your own process labelling)
PROFILE=offline_fast
# Speak a startup message when STT and TTS are both ready
ONLINE_ANNOUNCE=1
ONLINE_ANNOUNCE_TEXT=System online.

########################################
# TTS Worker (apps/tts-worker)
########################################
# Piper voice path inside container
PIPER_VOICE=/voices/TARS.onnx
# Streaming synthesis (attempt to reduce time-to-first-audio)
TTS_STREAMING=0
# Pipeline sentence-by-sentence
TTS_PIPELINE=1
# Number of concurrent synth workers when pipelining (only affects non-streaming)
TTS_CONCURRENCY=1
# Use simpleaudio for playback (in-process) instead of paplay/aplay
# Note: simpleaudio not installed by default; see REFACTOR_NOTES.md
TTS_SIMPLEAUDIO=0

########################################
# UI Web (apps/ui-web)
########################################
UI_PARTIAL_TOPIC=stt/partial
UI_FINAL_TOPIC=stt/final
UI_TTS_TOPIC=tts/status
UI_AUDIO_TOPIC=stt/audio_fft

########################################
# Pygame UI (apps/ui)
########################################
# Optional: point to TOML config mounted into container
UI_CONFIG=/config/ui.toml
# Env overrides for UI config (optional)
UI_WIDTH=800
UI_HEIGHT=480
UI_FPS=30
UI_NUM_BARS=64
UI_FONT=Arial
